<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  
  <link rel="shortcut icon" href="../../../img/favicon.ico">
  <title>Finding Common Pathways Used by Drugs - SamirDocs</title>
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  <link rel="stylesheet" href="../../../css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../css/theme_extra.css" type="text/css" />
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css">
  
  <script>
    // Current page data
    var mkdocs_page_name = "Finding Common Pathways Used by Drugs";
    var mkdocs_page_input_path = "implementation/Explore_Drug_chemical_OxStress/Explore_Drug_chemical_OxStress.md";
    var mkdocs_page_url = null;
  </script>
  
  <script src="../../../js/jquery-2.1.1.min.js" defer></script>
  <script src="../../../js/modernizr-2.8.3.min.js" defer></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script> 
  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
      <div class="wy-side-nav-search">
        <a href="../../.." class="icon icon-home"> SamirDocs</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
	<ul class="current">
	  
          
            <li class="toctree-l1">
		
    <a class="" href="../../..">Home</a>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Implementation</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../chemical_drug_elastic_occurance/chemical_drug_elastic_occurance/">Querying ElasticSearch for Drug/Chemical Occurrence</a>
                </li>
                <li class="">
                    
    <a class="" href="../../Occurrence_Count_Plots/Occurrence_Count_Plots/">Visualizing Distribution of Data in Pubmed</a>
                </li>
                <li class="">
                    
    <a class="" href="../../create_oxidative_stress_categories/create_oxidative_stress_categories/">Generating Final Inputs for CaseOLAP</a>
                </li>
                <li class=" current">
                    
    <a class="current" href="./">Finding Common Pathways Used by Drugs</a>
    <ul class="subnav">
            
    <li class="toctree-l3"><a href="#caseolap-score-linking-drugs-to-reactome-pathways">CaseOLAP Score + Linking Drugs to Reactome Pathways</a></li>
    
        <ul>
        
            <li><a class="toctree-l4" href="#importing-curated-lists-of-drugs-and-chemicals">Importing curated lists of drugs and chemicals</a></li>
        
            <li><a class="toctree-l4" href="#looking-for-reactome-ids-of-drugs-in-curated-list">Looking for reactome ids of drugs in curated list</a></li>
        
            <li><a class="toctree-l4" href="#looking-for-reactions-associated-with-each-drug-found-in-the-reactome-database">Looking for reactions associated with each drug found in the Reactome database</a></li>
        
            <li><a class="toctree-l4" href="#test-cypher-queries-in-custom-neo4j-driver-implementation">Test Cypher Queries in custom neo4j driver implementation</a></li>
        
        </ul>
    

    </ul>
                </li>
                <li class="">
                    
    <a class="" href="../../Create_Drug_Cooccurance_Graph/">Creating Drug/Chemical Co-Occurence GraphDB</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Instruction</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../../instructions/Query_Python_Elastic/">Querying ElasticSearch in Python</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../instructions/Query_Neo4j_Python/">Querying Neo4J in Python</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../instructions/Export_Subgraph/">Export Neo4J Subgraph in Python</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../instructions/Import_Subgraph/">Import GraphML Subgraph to Neo4J in Python</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Notes</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../../notes/Databases/">Databases</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../notes/ElasticSearch/">ElasticSearch</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../notes/neo4j/">Neo4J And Cypher</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../notes/DNA_Repair_Pathway_Notes/DNA_Repair_Pathways/">DNA Repair Pathways</a>
                </li>
    </ul>
	    </li>
          
        </ul>
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../../..">SamirDocs</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../../..">Docs</a> &raquo;</li>
    
      
        
          <li>Implementation &raquo;</li>
        
      
    
    <li>Finding Common Pathways Used by Drugs</li>
    <li class="wy-breadcrumbs-aside">
      
    </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <h1 id="caseolap-score-linking-drugs-to-reactome-pathways">CaseOLAP Score + Linking Drugs to Reactome Pathways</h1>
<p>This notebook first tries to map drugs curated by Alex and David to entities in Reactome. Next these reactome entites are mapped to pathways and reactions. The caseolap score for drugs in a pathway are averaged and plotted.</p>
<hr />
<p>Samir Akre - December 2019</p>
<pre class="codehilite"><code class="language-python">import neo4j_functions.driver as neo4j_driver
import pandas as pd
import importlib
import progressbar
import seaborn as sns
import matplotlib.pyplot as plt</code></pre>


<h2 id="importing-curated-lists-of-drugs-and-chemicals">Importing curated lists of drugs and chemicals</h2>
<pre class="codehilite"><code class="language-python">chemical_list_df = pd.read_csv('lib/oxidative_stress_chemicals_SA_10222019.csv')
drug_list_df = pd.read_csv('lib/drug_list_SA_10222019.csv')</code></pre>


<pre class="codehilite"><code class="language-python">chemical_list_df.head(n=2)</code></pre>


<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Biological Events of Oxidative Stress</th>
      <th>Molecular and Functional Categories</th>
      <th>Molecule/Enzyme/Protein</th>
      <th>MeSH Heading</th>
      <th>MeSH Supplementary</th>
      <th>MeSH tree numbers</th>
      <th>Chemical Formula</th>
      <th>Examples</th>
      <th>Pharm Actions</th>
      <th>Tree Numbers</th>
      <th>References</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>Initiation of Oxidative</td>
      <td>Reactive Oxygen Species (ROS)</td>
      <td>Superoxide (anion radical)</td>
      <td>Superoxides</td>
      <td>NaN</td>
      <td>D01.248.497.158.685.750.850; D01.339.431.374.8...</td>
      <td>O2-</td>
      <td>Superoxide, Hydrogen Peroxide</td>
      <td>Oxidants</td>
      <td>D27.720.642,\nD27.888.569.540</td>
      <td>PMID: 25547488</td>
    </tr>
    <tr>
      <td>1</td>
      <td>Initiation of Oxidative</td>
      <td>Reactive Oxygen Species (ROS)</td>
      <td>Hydrogen Peroxide</td>
      <td>Hydrogen Peroxide</td>
      <td>NaN</td>
      <td>D01.248.497.158.685.750.424; D01.339.431.374.4...</td>
      <td>H2O2</td>
      <td>NaN</td>
      <td>Anti-Infective Agents, Local</td>
      <td>D27.505.954.122.187</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>

<pre class="codehilite"><code class="language-python">drug_list_df.head(n=2)</code></pre>


<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Drug Category</th>
      <th>#</th>
      <th>Name</th>
      <th>Synonyms</th>
      <th>MeSH Descriptor</th>
      <th>MeSH tree(s)</th>
      <th>Common adverse effects</th>
      <th>Dosage (freq/amount/time/delivery)</th>
      <th>Duration (time)</th>
      <th>Pharm Action</th>
      <th>...</th>
      <th>Unnamed: 1015</th>
      <th>Unnamed: 1016</th>
      <th>Unnamed: 1017</th>
      <th>Unnamed: 1018</th>
      <th>Unnamed: 1019</th>
      <th>Unnamed: 1020</th>
      <th>Unnamed: 1021</th>
      <th>Unnamed: 1022</th>
      <th>Unnamed: 1023</th>
      <th>Unnamed: 1024</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>Anticoagulants</td>
      <td>1.0</td>
      <td>heparin</td>
      <td>['Calciparine', 'Eparina', 'heparina', 'Hepari...</td>
      <td>heparin</td>
      <td>D09.698.373.400</td>
      <td>Thrombocytopenia, Cerebral haemorrhage, Haemog...</td>
      <td>1/18U/kg/iv</td>
      <td>2 days</td>
      <td>Anticoagulants, \nFibrinolytic Agents</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <td>1</td>
      <td>Anticoagulants</td>
      <td>2.0</td>
      <td>warfarin</td>
      <td>['4-Hydroxy-3-(3-oxo-1-phenylbutyl)coumarin', ...</td>
      <td>warfarin</td>
      <td>D03.383.663.283.446.520.914\nD03.633.100.150.4...</td>
      <td>Haemorrhage, Haematoma, anaemia, Epistaxis, hy...</td>
      <td>1/2-10mg/day/po</td>
      <td>As needed</td>
      <td>Anticoagulants, \nRodenticides</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>2 rows Ã— 1025 columns</p>
</div>

<h2 id="looking-for-reactome-ids-of-drugs-in-curated-list">Looking for reactome ids of drugs in curated list</h2>
<p>Looks for the lower case name of the drug from the curated list to match any of the lowercase names a drug in reactome is listed in.  </p>
<ul>
<li>Outputs pandas data frame under variable <code>drugs_in_reactome</code></li>
<li>58/155 drugs found to have counter parts in reactome</li>
</ul>
<pre class="codehilite"><code class="language-python">importlib.reload(neo4j_driver)
reactome_driver = neo4j_driver.driver(uri = &quot;bolt://localhost:7687&quot;, user = &quot;neo4j&quot;, password = &quot;Akre1234&quot;)</code></pre>


<h3 id="test-to-see-if-i-can-find-any-drug-in-the-reactome-data-set">Test to see if I can find any drug in the reactome data set</h3>
<pre class="codehilite"><code class="language-python">reactome_driver.search_item_in_array(
    array_field=&quot;name&quot;,
    item='&quot;herceptin&quot;',
    class_type='Drug',
    info_cols = ['displayName', 'stId', 'isInDisease'],
    verbose=True
)</code></pre>


<pre class="codehilite"><code>Query: 
 MATCH (a:Drug) WHERE toLower(&quot;herceptin&quot;) IN [x in a.name | toLower(x)] RETURN a.displayName, a.stId, a.isInDisease</code></pre>


<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>displayName</th>
      <th>stId</th>
      <th>isInDisease</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>trastuzumab [extracellular region]</td>
      <td>R-ALL-9634466</td>
      <td>True</td>
    </tr>
  </tbody>
</table>
</div>

<h3 id="querying-to-find-reactome-id-for-each-drug-in-curated-list">Querying to find reactome ID for each drug in curated list</h3>
<ul>
<li>TODO: Refine search criteria</li>
</ul>
<pre class="codehilite"><code class="language-python">drugs_in_reactome = pd.DataFrame()
for (drug_name, drug_cat), _ in drug_list_df.groupby(['Name', 'Drug Category']):
    result = reactome_driver.search_item_in_array(
        array_field=&quot;name&quot;,
        item='&quot;%s&quot;' % drug_name,
        class_type='Drug',
        info_cols = ['displayName', 'stId', 'isInDisease']
    )
    result['Name'] = drug_name
    result['drug_cat'] = drug_cat.strip()
    drugs_in_reactome = drugs_in_reactome.append(result)
drugs_in_reactome.head()</code></pre>


<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>displayName</th>
      <th>stId</th>
      <th>isInDisease</th>
      <th>Name</th>
      <th>drug_cat</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>acebutolol [extracellular region]</td>
      <td>R-ALL-9610988</td>
      <td>True</td>
      <td>acebutolol</td>
      <td>Beta Blockers</td>
    </tr>
    <tr>
      <td>0</td>
      <td>amlodipine [extracellular region]</td>
      <td>R-ALL-9614079</td>
      <td>True</td>
      <td>amlodipine</td>
      <td>Calcium Antagonist</td>
    </tr>
    <tr>
      <td>0</td>
      <td>apixaban [extracellular region]</td>
      <td>R-ALL-9038732</td>
      <td>True</td>
      <td>apixaban</td>
      <td>Thrombolytics</td>
    </tr>
    <tr>
      <td>0</td>
      <td>atenolol [extracellular region]</td>
      <td>R-ALL-9610989</td>
      <td>True</td>
      <td>atenolol</td>
      <td>Beta Blockers</td>
    </tr>
    <tr>
      <td>0</td>
      <td>benazepril [endoplasmic reticulum lumen]</td>
      <td>R-ALL-9619005</td>
      <td>True</td>
      <td>benazepril</td>
      <td>ACE Inhibitors</td>
    </tr>
  </tbody>
</table>
</div>

<pre class="codehilite"><code class="language-python">print('Initial Drug List Size: ', drug_list_df.Name.nunique())
print('Drugs found in Reactome: ', drugs_in_reactome.Name.nunique())</code></pre>


<pre class="codehilite"><code>Initial Drug List Size:  156
Drugs found in Reactome:  58</code></pre>


<pre class="codehilite"><code class="language-python">drugs_in_reactome.groupby('Name').drug_cat.unique()</code></pre>


<pre class="codehilite"><code>Name
acebutolol                                     [Beta Blockers]
amlodipine                                [Calcium Antagonist]
apixaban                                       [Thrombolytics]
atenolol                                       [Beta Blockers]
benazepril                                    [ACE Inhibitors]
betaxolol                                      [Beta Blockers]
candesartan                       [Angiotensin II Antagonists]
cangrelor                                      [Antiplatelets]
captopril                                     [ACE Inhibitors]
carvedilol                                     [Beta Blockers]
clopidogrel                                    [Antiplatelets]
dabigatran                                     [Thrombolytics]
diltiazem       [Calcium Antagonist, Calcium Channel Blockers]
disopyramide                             [Na Channel Blockers]
dobutamine                                         [Inotropes]
dofetilide                        [Potassium Channel Blockers]
edoxaban                                       [Thrombolytics]
enalapril                                     [ACE Inhibitors]
enoximone                        [Phosphodiesterase Inhbitors]
esmolol                                        [Beta Blockers]
felodipine                                [Calcium Antagonist]
flecainide                               [Na Channel Blockers]
fosinopril                                    [ACE Inhibitors]
ibutilide                         [Potassium Channel Blockers]
irbesartan                        [Angiotensin II Antagonists]
isoprenaline                                       [Inotropes]
isradipine                                [Calcium Antagonist]
labetalol                                      [Beta Blockers]
lidocaine                                [Na Channel Blockers]
lisinopril                                    [ACE Inhibitors]
losartan                          [Angiotensin II Antagonists]
metoprolol                                     [Beta Blockers]
mexiletine                               [Na Channel Blockers]
milrinone                        [Phosphodiesterase Inhbitors]
nebivolol                                      [Beta Blockers]
nicardipine                               [Calcium Antagonist]
nifedipine                                [Calcium Antagonist]
nisoldipine                               [Calcium Antagonist]
olmesartan                        [Angiotensin II Antagonists]
perindopril                                   [ACE Inhibitors]
phenytoin                                [Na Channel Blockers]
pindolol                                       [Beta Blockers]
prasugrel                                      [Antiplatelets]
procainamide                             [Na Channel Blockers]
propafenone                              [Na Channel Blockers]
propranolol                                    [Beta Blockers]
quinapril                                     [ACE Inhibitors]
quinidine                                [Na Channel Blockers]
ramipril                                      [ACE Inhibitors]
rivaroxaban                                    [Thrombolytics]
sotalol            [Beta Blockers, Potassium Channel Blockers]
telmisartan                       [Angiotensin II Antagonists]
ticagrelor                                     [Antiplatelets]
ticlopidine                                    [Antiplatelets]
tocainide                                [Na Channel Blockers]
valsartan                         [Angiotensin II Antagonists]
verapamil       [Calcium Antagonist, Calcium Channel Blockers]
warfarin                                      [Anticoagulants]
Name: drug_cat, dtype: object</code></pre>


<pre class="codehilite"><code class="language-python">caseolap_results = pd.read_csv('lib/caseolap.csv')
drugs_with_caseOLAP = drugs_in_reactome.merge(
    caseolap_results.rename(columns={'protein': 'Name'}),
    how='inner',
    validate='m:1'
).set_index('Name')
print('Drugs found in caseOLAP and Reactome: ', drugs_with_caseOLAP.displayName.nunique())
drugs_with_caseOLAP.head()</code></pre>


<pre class="codehilite"><code>Drugs found in caseOLAP and Reactome:  58</code></pre>


<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>displayName</th>
      <th>stId</th>
      <th>isInDisease</th>
      <th>drug_cat</th>
      <th>IoOS</th>
      <th>OoOS</th>
      <th>RoOS</th>
    </tr>
    <tr>
      <th>Name</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>acebutolol</td>
      <td>acebutolol [extracellular region]</td>
      <td>R-ALL-9610988</td>
      <td>True</td>
      <td>Beta Blockers</td>
      <td>0.037757</td>
      <td>0.070040</td>
      <td>0.074837</td>
    </tr>
    <tr>
      <td>amlodipine</td>
      <td>amlodipine [extracellular region]</td>
      <td>R-ALL-9614079</td>
      <td>True</td>
      <td>Calcium Antagonist</td>
      <td>0.184230</td>
      <td>0.120305</td>
      <td>0.138113</td>
    </tr>
    <tr>
      <td>apixaban</td>
      <td>apixaban [extracellular region]</td>
      <td>R-ALL-9038732</td>
      <td>True</td>
      <td>Thrombolytics</td>
      <td>0.043904</td>
      <td>0.069014</td>
      <td>0.028798</td>
    </tr>
    <tr>
      <td>atenolol</td>
      <td>atenolol [extracellular region]</td>
      <td>R-ALL-9610989</td>
      <td>True</td>
      <td>Beta Blockers</td>
      <td>0.166591</td>
      <td>0.081671</td>
      <td>0.139500</td>
    </tr>
    <tr>
      <td>benazepril</td>
      <td>benazepril [endoplasmic reticulum lumen]</td>
      <td>R-ALL-9619005</td>
      <td>True</td>
      <td>ACE Inhibitors</td>
      <td>0.082279</td>
      <td>0.062858</td>
      <td>0.094923</td>
    </tr>
  </tbody>
</table>
</div>

<pre class="codehilite"><code class="language-python">import json
drug_pal_dict = json.load(open('lib/drug_cat_palette.json', 'r'))
chem_pal_dict = json.load(open('lib/chem_cat_palette.json', 'r'))
print(chem_pal_dict)</code></pre>


<pre class="codehilite"><code>{'Initiation of Oxidative': [0.86, 0.3712, 0.33999999999999997], 'Outcomes of Oxidative Stress': [0.33999999999999997, 0.86, 0.3712], 'Regulation of Oxidative Stress': [0.3712, 0.33999999999999997, 0.86]}</code></pre>


<p><strong>NOTE</strong>: Color of drug categories (label on far left) seems to be buggy. Propafenone should be white, but is not. Warfarin is white but should be blue.</p>
<pre class="codehilite"><code class="language-python">drugs_with_caseOLAP['color'] = drugs_with_caseOLAP.drug_cat.map(drug_pal_dict).fillna('white')

clust = sns.clustermap(
    drugs_with_caseOLAP[['IoOS', 'OoOS', 'RoOS']].drop_duplicates(),
    figsize=(6,16),
    row_colors=drugs_with_caseOLAP['color'],
    col_colors=[chem_pal_dict[cat] for cat in ['Initiation of Oxidative', 'Outcomes of Oxidative Stress', 'Regulation of Oxidative Stress']]
)

ax = clust.ax_heatmap
y_lims = ax.get_ylim()
ax.set_ylim([y_lims[0] + 0.5, y_lims[1] - .5])</code></pre>


<pre class="codehilite"><code>(58.0, 0.0)</code></pre>


<p><img alt="png" src="../output_17_1.png" /></p>
<h2 id="looking-for-reactions-associated-with-each-drug-found-in-the-reactome-database">Looking for reactions associated with each drug found in the Reactome database</h2>
<ul>
<li>Looks for 25 "nearest" pathways marked as <code>Pathways</code> to any drug within 1-3 nodes</li>
<li>Outputs to <code>pathways</code> variable as a pandas dataframe</li>
<li>Creates CSV <code>output/drug_reactome_pathways_caseolap.csv</code></li>
</ul>
<pre class="codehilite"><code class="language-python"># Re-initializing driver to account for changes made to driver function
importlib.reload(neo4j_driver)
driver = neo4j_driver.driver(uri = &quot;bolt://localhost:7687&quot;, user = &quot;neo4j&quot;, password = &quot;Akre1234&quot;)

# For each reactome drug ID, looks for &quot;closest&quot; pathways within 1-2 nodes 
reactions = pd.DataFrame()
for (reactome_id, IoOS, OoOS, RoOS), d_df, in progressbar.progressbar(drugs_with_caseOLAP.groupby(['stId', 'IoOS', 'OoOS', 'RoOS'])):
    query = (
        &quot;&quot;&quot;
        MATCH (a:Drug {stId: '%s'})-[]-(c)-[]-(b:ReactionLikeEvent)&lt;-[:hasEvent]-(p:Pathway)
        WHERE b.speciesName = 'Homo sapiens'
        AND NOT c.schemaClass IN ['Compartment', 'InstanceEdit']
        RETURN DISTINCT a.displayName, b.displayName, c.displayName, c.schemaClass, p.displayName
        &quot;&quot;&quot; % (reactome_id)
    )
    query_res = driver.run_query(query)
    result = driver.results_to_df(query_res, ['a.displayName', 'b.displayName', 'c.displayName', 'c.schemaClass', 'p.displayName'])
    result['IoOS'] = IoOS
    result['OoOS'] = OoOS
    result['RoOS'] = RoOS

    reactions = reactions.append(result, ignore_index=True, sort=False)

reactions = reactions.rename(
    columns={
        'a.displayName': 'Drug',
        'b.displayName': 'Reaction',
        'c.displayName': 'Intermediate Node',
        'c.schemaClass': 'Intermediate Class',
        'p.displayName': 'Pathway'
    }
)
reactions.to_csv('output/drug_reactome_reactions_caseolap.csv', index=False)
reactions.head()</code></pre>


<pre class="codehilite"><code>100% (58 of 58) |########################| Elapsed Time: 0:00:01 Time:  0:00:01</code></pre>


<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Drug</th>
      <th>Reaction</th>
      <th>Intermediate Node</th>
      <th>Intermediate Class</th>
      <th>Pathway</th>
      <th>IoOS</th>
      <th>OoOS</th>
      <th>RoOS</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>warfarin [cytosol]</td>
      <td>VKORC1 inhibitors binds VKORC1 dimer</td>
      <td>VKORC1 inhibitors [cytosol]</td>
      <td>DefinedSet</td>
      <td>Metabolism of vitamin K</td>
      <td>0.077812</td>
      <td>0.261603</td>
      <td>0.164026</td>
    </tr>
    <tr>
      <td>1</td>
      <td>warfarin [cytosol]</td>
      <td>VKORC1 inhibitors binds VKORC1 dimer</td>
      <td>Warfarin traps human vitamin K epoxide reducta...</td>
      <td>LiteratureReference</td>
      <td>Metabolism of vitamin K</td>
      <td>0.077812</td>
      <td>0.261603</td>
      <td>0.164026</td>
    </tr>
    <tr>
      <td>2</td>
      <td>warfarin [cytosol]</td>
      <td>VKORC1 inhibitors binds VKORC1 dimer</td>
      <td>Warfarin and vitamin K compete for binding to ...</td>
      <td>LiteratureReference</td>
      <td>Metabolism of vitamin K</td>
      <td>0.077812</td>
      <td>0.261603</td>
      <td>0.164026</td>
    </tr>
    <tr>
      <td>3</td>
      <td>warfarin [cytosol]</td>
      <td>VKORC1 inhibitors binds VKORC1 dimer</td>
      <td>Pharmacogenetic-guided dosing of coumarin anti...</td>
      <td>LiteratureReference</td>
      <td>Metabolism of vitamin K</td>
      <td>0.077812</td>
      <td>0.261603</td>
      <td>0.164026</td>
    </tr>
    <tr>
      <td>4</td>
      <td>warfarin [cytosol]</td>
      <td>VKORC1 inhibitors binds VKORC1 dimer</td>
      <td>[On the history of vitamin K, dicoumarol and w...</td>
      <td>LiteratureReference</td>
      <td>Metabolism of vitamin K</td>
      <td>0.077812</td>
      <td>0.261603</td>
      <td>0.164026</td>
    </tr>
  </tbody>
</table>
</div>

<pre class="codehilite"><code class="language-python">reactions = pd.read_csv('output/drug_reactome_reactions_caseolap.csv')
print('Drugs remaining:', reactions.Drug.nunique())
pd.DataFrame(reactions.groupby('Pathway').Drug.nunique()).sort_values(by='Drug', ascending=False)</code></pre>


<pre class="codehilite"><code>Drugs remaining: 35</code></pre>


<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Drug</th>
    </tr>
    <tr>
      <th>Pathway</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Adrenoceptors</td>
      <td>11</td>
    </tr>
    <tr>
      <td>Metabolism of Angiotensinogen to Angiotensins</td>
      <td>8</td>
    </tr>
    <tr>
      <td>Peptide ligand-binding receptors</td>
      <td>6</td>
    </tr>
    <tr>
      <td>Common Pathway of Fibrin Clot Formation</td>
      <td>5</td>
    </tr>
    <tr>
      <td>Intrinsic Pathway of Fibrin Clot Formation</td>
      <td>5</td>
    </tr>
    <tr>
      <td>P2Y receptors</td>
      <td>5</td>
    </tr>
    <tr>
      <td>Defective CYP1B1 causes Glaucoma</td>
      <td>1</td>
    </tr>
    <tr>
      <td>Metabolism of vitamin K</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div>

<pre class="codehilite"><code class="language-python"># Pathway by sum score in each category
pathways_IoOS = pd.DataFrame(
    reactions.groupby('Pathway').IoOS.mean()
).reset_index().sort_values(by='IoOS', ascending=False)
pathways_IoOS.head()

# Plotting top 15 and bottom 10 pathways
sns.set_context('talk', font_scale=1.5)
fig, ax = plt.subplots(figsize=(8, 12))
sns.barplot(
    y='Pathway',
    x='IoOS',
    order=pd.concat([pathways_IoOS.head(15), pathways_IoOS.tail(10)]).drop_duplicates().Pathway,
    data=reactions,
    ax=ax
)
ax.set_xlabel('Mean Score for Initiation')
ax.set_ylabel('')
ax.set_title('IoOS')

sns.despine()


# Pathway by sum score in each category
pathways_RoOS = pd.DataFrame(
    reactions.groupby('Pathway').RoOS.mean()
).reset_index().sort_values(by='RoOS', ascending=False)
pathways_IoOS.head()

# Plotting top 15 and bottom 10 pathways
sns.set_context('talk', font_scale=1.5)
fig, ax = plt.subplots(figsize=(8, 12))
sns.barplot(
    y='Pathway',
    x='RoOS',
    order=pd.concat([pathways_IoOS.head(15), pathways_IoOS.tail(10)]).drop_duplicates().Pathway,
    data=reactions,
    ax=ax
)
ax.set_xlabel('Mean Score for Regulation')
ax.set_ylabel('')
ax.set_title('RoOS')

sns.despine()

# Pathway by sum score in each category
pathways_OoOS = pd.DataFrame(
    reactions.groupby('Pathway').OoOS.mean()
).reset_index().sort_values(by='OoOS', ascending=False)

# Plotting top 15 and bottom 10 pathways
sns.set_context('talk', font_scale=1.5)
fig, ax = plt.subplots(figsize=(8, 12))
sns.barplot(
    y='Pathway',
    x='OoOS',
    order=pd.concat([pathways_IoOS.head(15), pathways_IoOS.tail(10)]).drop_duplicates().Pathway,
    data=reactions,
    ax=ax
)
ax.set_xlabel('Mean Score for Outcomes')
ax.set_ylabel('')
ax.set_title('OoOS')

sns.despine()</code></pre>


<p><img alt="png" src="../output_21_0.png" /></p>
<p><img alt="png" src="../output_21_1.png" /></p>
<p><img alt="png" src="../output_21_2.png" /></p>
<pre class="codehilite"><code class="language-python"># Pathway by sum score in each category
pathways_IoOS = pd.DataFrame(
    reactions.groupby('Reaction').IoOS.mean()
).reset_index().sort_values(by='IoOS', ascending=False)
pathways_IoOS.head()

# Plotting top 15 and bottom 10 pathways
sns.set_context('talk', font_scale=1.5)
fig, ax = plt.subplots(figsize=(8, 12))
sns.barplot(
    y='Reaction',
    x='IoOS',
    order=pd.concat([pathways_IoOS.head(15), pathways_IoOS.tail(10)]).drop_duplicates().Reaction,
    data=reactions,
    ax=ax
)
ax.set_xlabel('Mean Score for Initiation')
ax.set_ylabel('')
ax.set_title('IoOS')

sns.despine()


# Pathway by sum score in each category
pathways_RoOS = pd.DataFrame(
    reactions.groupby('Reaction').RoOS.mean()
).reset_index().sort_values(by='RoOS', ascending=False)
pathways_IoOS.head()

# Plotting top 15 and bottom 10 pathways
sns.set_context('talk', font_scale=1.5)
fig, ax = plt.subplots(figsize=(8, 12))
sns.barplot(
    y='Reaction',
    x='RoOS',
    order=pd.concat([pathways_IoOS.head(15), pathways_IoOS.tail(10)]).drop_duplicates().Reaction,
    data=reactions,
    ax=ax
)
ax.set_xlabel('Mean Score for Regulation')
ax.set_ylabel('')
ax.set_title('RoOS')

sns.despine()

# Pathway by sum score in each category
pathways_OoOS = pd.DataFrame(
    reactions.groupby('Reaction').OoOS.mean()
).reset_index().sort_values(by='OoOS', ascending=False)

# Plotting top 15 and bottom 10 pathways
sns.set_context('talk', font_scale=1.5)
fig, ax = plt.subplots(figsize=(8, 12))
sns.barplot(
    y='Reaction',
    x='OoOS',
    order=pd.concat([pathways_IoOS.head(15), pathways_IoOS.tail(10)]).drop_duplicates().Reaction,
    data=reactions,
    ax=ax
)
ax.set_xlabel('Mean Score for Outcomes')
ax.set_ylabel('')
ax.set_title('OoOS')

sns.despine()</code></pre>


<p><img alt="png" src="../output_22_0.png" /></p>
<p><img alt="png" src="../output_22_1.png" /></p>
<p><img alt="png" src="../output_22_2.png" /></p>
<pre class="codehilite"><code class="language-python">reactions[reactions.Drug.str.contains('warfarin')]</code></pre>


<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Drug</th>
      <th>Reaction</th>
      <th>Intermediate Node</th>
      <th>Intermediate Class</th>
      <th>Pathway</th>
      <th>IoOS</th>
      <th>OoOS</th>
      <th>RoOS</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>warfarin [cytosol]</td>
      <td>VKORC1 inhibitors binds VKORC1 dimer</td>
      <td>VKORC1 inhibitors [cytosol]</td>
      <td>DefinedSet</td>
      <td>Metabolism of vitamin K</td>
      <td>0.077812</td>
      <td>0.261603</td>
      <td>0.164026</td>
    </tr>
    <tr>
      <td>1</td>
      <td>warfarin [cytosol]</td>
      <td>VKORC1 inhibitors binds VKORC1 dimer</td>
      <td>Warfarin traps human vitamin K epoxide reducta...</td>
      <td>LiteratureReference</td>
      <td>Metabolism of vitamin K</td>
      <td>0.077812</td>
      <td>0.261603</td>
      <td>0.164026</td>
    </tr>
    <tr>
      <td>2</td>
      <td>warfarin [cytosol]</td>
      <td>VKORC1 inhibitors binds VKORC1 dimer</td>
      <td>Warfarin and vitamin K compete for binding to ...</td>
      <td>LiteratureReference</td>
      <td>Metabolism of vitamin K</td>
      <td>0.077812</td>
      <td>0.261603</td>
      <td>0.164026</td>
    </tr>
    <tr>
      <td>3</td>
      <td>warfarin [cytosol]</td>
      <td>VKORC1 inhibitors binds VKORC1 dimer</td>
      <td>Pharmacogenetic-guided dosing of coumarin anti...</td>
      <td>LiteratureReference</td>
      <td>Metabolism of vitamin K</td>
      <td>0.077812</td>
      <td>0.261603</td>
      <td>0.164026</td>
    </tr>
    <tr>
      <td>4</td>
      <td>warfarin [cytosol]</td>
      <td>VKORC1 inhibitors binds VKORC1 dimer</td>
      <td>[On the history of vitamin K, dicoumarol and w...</td>
      <td>LiteratureReference</td>
      <td>Metabolism of vitamin K</td>
      <td>0.077812</td>
      <td>0.261603</td>
      <td>0.164026</td>
    </tr>
    <tr>
      <td>5</td>
      <td>warfarin [cytosol]</td>
      <td>Factor Xa inhibitors bind Va:Xa</td>
      <td>pulmonary embolism</td>
      <td>Disease</td>
      <td>Common Pathway of Fibrin Clot Formation</td>
      <td>0.077812</td>
      <td>0.261603</td>
      <td>0.164026</td>
    </tr>
    <tr>
      <td>6</td>
      <td>warfarin [cytosol]</td>
      <td>Factor Xa inhibitors binds Xa</td>
      <td>pulmonary embolism</td>
      <td>Disease</td>
      <td>Common Pathway of Fibrin Clot Formation</td>
      <td>0.077812</td>
      <td>0.261603</td>
      <td>0.164026</td>
    </tr>
    <tr>
      <td>7</td>
      <td>warfarin [cytosol]</td>
      <td>Factor IIa inhibitors (compounds) binds IIa</td>
      <td>pulmonary embolism</td>
      <td>Disease</td>
      <td>Intrinsic Pathway of Fibrin Clot Formation</td>
      <td>0.077812</td>
      <td>0.261603</td>
      <td>0.164026</td>
    </tr>
    <tr>
      <td>8</td>
      <td>warfarin [cytosol]</td>
      <td>Factor IIa inhibitors (peptide) binds IIa</td>
      <td>pulmonary embolism</td>
      <td>Disease</td>
      <td>Intrinsic Pathway of Fibrin Clot Formation</td>
      <td>0.077812</td>
      <td>0.261603</td>
      <td>0.164026</td>
    </tr>
  </tbody>
</table>
</div>

<pre class="codehilite"><code class="language-python">import sys
sys.setrecursionlimit(100000)
sns.set_context('talk', font_scale=1)
sns.clustermap(reactions.groupby('Reaction')[['IoOS', 'RoOS', 'OoOS']].mean(), col_cluster=False, figsize=(4, 10))
sns.clustermap(reactions.groupby('Pathway')[['IoOS', 'RoOS', 'OoOS']].mean(), col_cluster=False, figsize=(4, 10))</code></pre>


<pre class="codehilite"><code>&lt;seaborn.matrix.ClusterGrid at 0x127026908&gt;</code></pre>


<p><img alt="png" src="../output_24_1.png" /></p>
<p><img alt="png" src="../output_24_2.png" /></p>
<h2 id="test-cypher-queries-in-custom-neo4j-driver-implementation">Test Cypher Queries in custom neo4j driver implementation</h2>
<p><em>This section is not used for analysis. I am leaving it here to serve as an example of functions usable in the driver.py file</em></p>
<pre class="codehilite"><code class="language-python">reactome_driver.get_node_info(
    id_field=&quot;stId&quot;,
    id_val=&quot;R-ALL-9634956&quot;,
    class_type='Drug',
    info_cols = ['displayName', 'name', 'isInDisease']
)</code></pre>


<pre class="codehilite"><code>Query: 
 MATCH (a:Drug {stId: $idnum}) RETURN a.displayName, a.name, a.isInDisease 
pyridostigmine [extracellular region]
['pyridostigmine']
True</code></pre>


<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>displayName</th>
      <th>name</th>
      <th>isInDisease</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>pyridostigmine [extracellular region]</td>
      <td>[pyridostigmine]</td>
      <td>True</td>
    </tr>
  </tbody>
</table>
</div>

<pre class="codehilite"><code class="language-python">reactome_driver.get_n_nodes_info(
    class_type='Drug',
    info_cols = ['displayName', 'name', 'isInDisease'],
    n=10
)</code></pre>


<pre class="codehilite"><code>Query: 
 MATCH (a:Drug) RETURN a.displayName, a.name, a.isInDisease LIMIT 10</code></pre>


<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>displayName</th>
      <th>name</th>
      <th>isInDisease</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>trastuzumab [extracellular region]</td>
      <td>[trastuzumab, herceptin, D5v8, R-597]</td>
      <td>True</td>
    </tr>
    <tr>
      <td>0</td>
      <td>CP-724714 [cytosol]</td>
      <td>[CP-724714]</td>
      <td>True</td>
    </tr>
    <tr>
      <td>0</td>
      <td>Afatinib [cytosol]</td>
      <td>[Afatinib, BIBW2992, Irreversible TKI inhibito...</td>
      <td>True</td>
    </tr>
    <tr>
      <td>0</td>
      <td>AZ5104 [cytosol]</td>
      <td>[AZ5104]</td>
      <td>True</td>
    </tr>
    <tr>
      <td>0</td>
      <td>Sapitinib [cytosol]</td>
      <td>[Sapitinib]</td>
      <td>True</td>
    </tr>
    <tr>
      <td>0</td>
      <td>Tesevatinib [cytosol]</td>
      <td>[Tesevatinib, EXEL-7647, XL-647, KD-019, XL647]</td>
      <td>True</td>
    </tr>
    <tr>
      <td>0</td>
      <td>Lapatinib [cytosol]</td>
      <td>[Lapatinib, GW572016, Tykerb, Reversible tyros...</td>
      <td>True</td>
    </tr>
    <tr>
      <td>0</td>
      <td>Neratinib [cytosol]</td>
      <td>[Neratinib, HKI-272, afatinib, Irreversible ty...</td>
      <td>True</td>
    </tr>
    <tr>
      <td>0</td>
      <td>AEE788 [cytosol]</td>
      <td>[AEE788]</td>
      <td>True</td>
    </tr>
    <tr>
      <td>0</td>
      <td>Canertinib [cytosol]</td>
      <td>[Canertinib, CI-1033, Irreversible TKI inhibit...</td>
      <td>True</td>
    </tr>
  </tbody>
</table>
</div>

<pre class="codehilite"><code class="language-python"></code></pre>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../../Create_Drug_Cooccurance_Graph/" class="btn btn-neutral float-right" title="Creating Drug/Chemical Co-Occurence GraphDB">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../../create_oxidative_stress_categories/create_oxidative_stress_categories/" class="btn btn-neutral" title="Generating Final Inputs for CaseOLAP"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="http://www.mkdocs.org">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
      
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" style="cursor: pointer">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
      
        <span><a href="../../create_oxidative_stress_categories/create_oxidative_stress_categories/" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../../Create_Drug_Cooccurance_Graph/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>
    <script>var base_url = '../../..';</script>
    <script src="../../../js/theme.js" defer></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML" defer></script>
      <script src="../../../search/main.js" defer></script>

</body>
</html>
